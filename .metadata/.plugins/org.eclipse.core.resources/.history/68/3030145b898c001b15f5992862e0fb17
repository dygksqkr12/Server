package com.kh.web.servlet;

import java.io.IOException;
import java.io.PrintWriter;
import java.util.Arrays;

import javax.servlet.RequestDispatcher;
import javax.servlet.ServletConfig;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class menuServlet extends HttpServlet {

	public menuServlet() {
		super();
	}

	@Override
	public void destroy() {
		System.out.println("destroy() 호출!");
	}

	@Override
	public void init(ServletConfig config) {
		System.out.println("init(ServletConfig) 호출!");
	}

	@Override
	protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
		System.out.println(this.hashCode());

		// 1. 사용자입력값 가져오기
		String main = req.getParameter("main");
		String side = req.getParameter("side");
		String drink = req.getParameter("drink");
		String num = req.getParameter("num");

		System.out.println("name = " + main);
		System.out.println("color = " + side);
		System.out.println("animal = " + drink);

		// 2. 응답메세지 작성 : html
		resp.setContentType("text/html; charset=utf-8");
		PrintWriter out = resp.getWriter();
		out.println("<!DOCTYPE html>");
		out.println("<html>");
		out.println("<head>");
		out.println("<title>주문</title>");
		out.println("</head>");
		out.println("<body>");
		out.println("<h2><strong>감사합니다.</strong></h2>");
		out.println("<p + <h1>" + main + "</h1>,<h2>" + side + "</h2>,<h3>" + drink + "</h3>을/를 주문하셨습니다.</p>");
		out.println("<p>총 결제금액은 <h1>" + num + "원</h1>입니다.</p>");
		out.println("</body>");
		out.println("</html>");
	}

	@Override
	protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		// 0. encoding 선언
				request.setCharacterEncoding("utf-8");

				// 1. 사용자입력값 변수에 담기
				String main = request.getParameter("main");
				String side = request.getParameter("side");
				String drink = request.getParameter("drink");
				String num = request.getParameter("num");

				System.out.println("main = " + main);
				System.out.println("side = " + side);
				System.out.println("drink = " + drink);
				System.out.println("num = " + num);

				// 2. 업무로직
				String recommendation = "";
				String colorName = "";
				switch (side) {
				case "빨강":
					recommendation = "빨간 짬뽕";
					colorName = "red";
					break;
				case "노랑":
					recommendation = "노란 참외";
					colorName = "yellow";
					break;
				case "초록":
					recommendation = "초록 시금치";
					colorName = "green";
					break;
				case "파랑":
					recommendation = "파랑 파워에이드";
					colorName = "blue";
					break;
				}

				// jsp에 새로 생선된 data를 전달하기 위해 request에 속성으로 저장한다.
				// key:String, value:Object 저장
				request.setAttribute("recommendation", recommendation);
				request.setAttribute("colorName", colorName);

				// 3. html작성을 jsp에 위임.
				// /(슬레시)로 시작한다면, /WebContent에서 조회함.
				RequestDispatcher reqDispatcher = request.getRequestDispatcher("/servlet/testPersonEnd.jsp");
				reqDispatcher.forward(request, response);

	}

}
